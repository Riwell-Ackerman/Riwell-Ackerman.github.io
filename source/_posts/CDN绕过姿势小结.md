---
title: CDN绕过姿势小结
date: 2019-08-11 18:25:08
categories: 旧时光
tags: 网络安全
---
公司的各业务主站都挂了CDN，总结一波CDN绕过技巧。

什么是CDN
CDN的全称是Content Delivery Network，即内容分发网络。

其基本思路是尽可能避开互联网上有可能影响数据传输速度和稳定性的瓶颈和环节，使内容传输的更快、更稳定。

我的简单理解就是：在cdn提供商的服务器上 “备份” 的目标服务器的一部分数据，用户在请求目标服务器时会转到cdn服务器上。

这样做的好处是显然的，首先是可以分摊掉自己服务器的一些负担，而且由于cdn服务商在各地都有服务器，能提高用户的访问速度，另外还可以防点DDOS攻击。

这里总结一下绕过CDN找出目标真实 IP 的方法。

查询DNS解析的历史纪录
查这个域名以前的IP，很有可能就有它的真实IP地址。

比如在它还没有cdn节点的时候，绑定的 IP 就是真实IP了。

但是更多的可能是那个IP已经不在用了。

https://myip.ms/

https://toolbar.netcraft.com/site_report

查询子域名或根域名的IP
很多时候网站做cdn会把主站加进去，而它的部分子域名没有加进去，这时查到的就是真实IP了，而主站很有可能就在同一个C段里。

还有就是根域名了，有的时候查www.xxxx.com是cdn的，但是直接查xxxx.com就不是了。

还有三级、四级子域名，可能性更大。

利用多地ping工具
由于地域和网络差异，会解析到不同的IP，尤其是在国外解析国内的时候，会直接解析到真实的IP。

同理，可以通过自行查询国外DNS。

但是如果它 cdn 做的很全的话就…

https://www.17ce.com/

http://ping.chinaz.com/

与网站进行交互
由于不是所有的数据都会走cdn，在与网站交互的某些流量还是会走到真实IP的。

比如一些对实时性要求较高的数据会跳过cdn，比如流媒体什么的，不排除有一些专门做流媒体的cdn了。

还有用户注册时的邮箱激活（或者是RSS邮件订阅），很有可能是用自己的邮件服务器（当然也有用其他的了），那么在这个IP的C段里很有可能就有主站的IP了。

另外还可以利用漏洞，用 xss，csrf 什么的，利用服务器的主动连接获取其IP地址。

全网扫描
这个就很厉害了，几乎是万能的，就是成本有点高。

通过扫描所有IP，根据目标网站的特征回应，找出其IP地址。

当然可以用现成的搜索引擎了，国外的shodan，fofa，国内的 zoomeye。

利用相关库
这个比较 6 的是针对cloudflare的数据库了，其他的貌似没什么。

http://www.crimeflare.com/

社会工程学
。。。。。。
